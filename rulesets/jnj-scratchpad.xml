<cpilint>
    <rules>
        <!-- Ensure Content Modifier datatypes are properly declared -->
        <undeclared-content-modifier-datatype-not-allowed/>

        <!-- ===== SECURITY RULES ===== -->
        <!-- Disallow cleartext basic authentication -->
        <cleartext-basic-auth-not-allowed/>
        
        <!-- Disallow client certificate sender channel authentication -->
        <client-cert-sender-channel-auth-not-allowed/>
        
        <!-- Require CSRF protection -->
        <csrf-protection-required/>
        
        <!-- Disallow unencrypted endpoints -->
        <unencrypted-endpoints-not-allowed/>
        
        <!-- Make sure that all data store writes are encrypted. -->
        <unencrypted-data-store-write-not-allowed/>

        <!-- ===== ADAPTER RULES ===== -->
        <!-- Disallow specific receiver adapters -->
        <disallowed-receiver-adapters>
            <disallow>facebook</disallow>
            <disallow>twitter</disallow>
        </disallowed-receiver-adapters>
        
        <!-- Disallow specific sender adapters -->
        <!--
        <disallowed-sender-adapters>
            <disallow>facebook</disallow>
            <disallow>twitter</disallow>
        </disallowed-sender-adapters>
        -->

        <!-- ===== NAMING RULES ===== -->
        <!-- Disallow default names -->
        <default-names-not-allowed/>
        
        <!-- Ensure iFlow name matches specific pattern -->
        <!--
        <iflow-name-matches>
            <pattern>^[A-Z][a-zA-Z0-9_]*$</pattern>
        </iflow-name-matches>
        -->
        
        <!-- Enforce naming conventions (configured in jnj-naming.xml) -->
        <!-- <naming-conventions/> -->

        <!-- ===== ROUTER RULES ===== -->
        <!-- Don't allow Router steps configured with both XML and non-XML conditions. -->
        <multi-condition-type-routers-not-allowed/>
        
        <!-- ===== MAPPING RULES ===== -->
        <!-- Message Mapping and XSLT are the two allowed mapping types. -->
        <allowed-mapping-types>
            <allow>message-mapping</allow>
            <allow>xslt-mapping</allow>
        </allowed-mapping-types>
        
        <!--
        <allowed-xslt-versions>
            <allow>1.0</allow>
            <allow>2.0</allow>
        </allowed-xslt-versions>
        -->

        <!-- ===== CHANNEL RULES ===== -->
        <matching-process-direct-channels-required/>

        <!-- ===== RESOURCE RULES ===== -->
        <!-- Disallow duplicate resources -->
        <duplicate-resources-not-allowed/>
        
        <!--
        <java-archives>
            <disallow>.*</disallow>
        </java-archives>
        -->

        <!-- ===== SCRIPTING RULES ===== -->
        <!--
        <scripting-languages>
            <allow>groovy</allow>
            <allow>javascript</allow>
        </scripting-languages>
        -->

        <!-- ===== PARAMETER RULES ===== -->
        <!-- Disallow unused parameters -->
        <unused-parameters-not-allowed/>

        <!--
        <user-roles>
            <allow>ESBMessageAdmin</allow>
            <allow>Developer</allow>
        </user-roles>
        -->

        <!-- Require that all iflows have a description. -->
        <iflow-description-required/>

        <!-- 
        ========================================================================
        Security-Related Rules
        ========================================================================
        -->

        <!-- Prevent cleartext basic authentication on unencrypted connections -->
        <cleartext-basic-auth-not-allowed/>

        <!-- Ensure all data store writes are encrypted -->
        <unencrypted-data-store-write-not-allowed/>

        <!-- Ensure all endpoints are encrypted -->
        <unencrypted-endpoints-not-allowed/>

        <!-- Ensure CSRF protection is enabled for HTTPS sender channels -->
        <csrf-protection-required/>

        <!-- 
        ========================================================================
        Routing & Process Configuration Rules
        ========================================================================
        -->

        <!-- Ensure all ProcessDirect receiver channels have matching sender channels -->
        <matching-process-direct-channels-required/>

        <!-- Don't allow Router steps configured with both XML and non-XML conditions -->
        <multi-condition-type-routers-not-allowed/>

        <!-- 
        ========================================================================
        Adapter-Related Rules
        ========================================================================
        -->

        <!-- Restrict usage of receiver adapters - default: disallow social media adapters -->
        <disallowed-receiver-adapters>
            <disallow>facebook</disallow>
            <disallow>twitter</disallow>
        </disallowed-receiver-adapters>

        <!-- Restrict usage of sender adapters - uncomment and configure as needed
        <disallowed-sender-adapters>
            <disallow>facebook</disallow>
            <disallow>twitter</disallow>
        </disallowed-sender-adapters>
        -->

        <!-- 
        ========================================================================
        Mapping & Scripting Rules
        ========================================================================
        -->

        <!-- Only allow specific mapping types -->
        <allowed-mapping-types>
            <allow>message-mapping</allow>
            <allow>xslt-mapping</allow>
            <allow>operation-mapping</allow>
        </allowed-mapping-types>

        <!-- Restrict scripting languages - uncomment if needed
        <disallowed-scripting-languages>
            <disallow>javascript</disallow>
        </disallowed-scripting-languages>
        -->

        <!-- 
        ========================================================================
        Resource Management Rules
        ========================================================================
        -->

        <!-- Prevent duplicate resources across integration flows -->
        <duplicate-resources-not-allowed>
            <resource-type>groovy-script</resource-type>
            <resource-type>javascript-script</resource-type>
            <resource-type>message-mapping</resource-type>
            <resource-type>xslt-mapping</resource-type>
            <resource-type>operation-mapping</resource-type>
            <resource-type>java-archive</resource-type>
            <resource-type>edmx</resource-type>
            <resource-type>wsdl</resource-type>
            <resource-type>xml-schema</resource-type>
        </duplicate-resources-not-allowed>

        <!-- Control which Java archives are allowed -->
        <!-- Uncomment and configure as needed
        <disallowed-java-archives>
            <disallow>your-unwanted-library-*.jar</disallow>
        </disallowed-java-archives>
        -->

        <!-- 
        ========================================================================
        User Role Rules
        ========================================================================
        -->

        <!-- Control which user roles can be used -->
        <!-- Uncomment and configure as needed
        <allowed-user-roles>
            <allow>JnJApproved</allow>
        </allowed-user-roles>
        -->



        <!-- 
        ========================================================================
        JnJ Naming Conventions
        Based on JnJ-NamingConventions.pdf and practice examples
        ========================================================================
        -->

        <!-- Integration Flow Naming Conventions -->
        <naming>
            <scheme>
                <regex>^[A-Z0-9].*_[A-Z0-9].*$</regex>
            </scheme>
            <message>Integration flow names should follow [SOURCE]_[TARGET] format</message>
            <apply-to>iflow.name</apply-to>
        </naming>

        <!-- Participant Naming Conventions -->
        <naming>
            <scheme>
                <or>
                    <starts-with>OP_</starts-with>
                    <starts-with>B2B_</starts-with>
                    <starts-with>CP_</starts-with>
                </or>
            </scheme>
            <message>Participant names must start with OP_ (on-premise), B2B_ (business partner), or CP_ (cloud provider)</message>
            <apply-to>sender.name</apply-to>
            <apply-to>receiver.name</apply-to>
        </naming>

        <!-- Channel Naming Conventions -->
        <!-- HTTP Receiver Channels -->
        <naming>
            <scheme>
                <starts-with>HTTP_RCV_</starts-with>
            </scheme>
            <message>HTTP receiver channel names must start with HTTP_RCV_</message>
            <apply-to>http-receiver-channel.name</apply-to>
        </naming>

        <!-- HTTPS Receiver Channels -->
        <naming>
            <scheme>
                <starts-with>HTTPS_RCV_</starts-with>
            </scheme>
            <message>HTTPS receiver channel names must start with HTTPS_RCV_</message>
            <apply-to>https-receiver-channel.name</apply-to>
        </naming>

        <!-- ProcessDirect Sender Channels -->
        <naming>
            <scheme>
                <starts-with>PD_SND_</starts-with>
            </scheme>
            <message>ProcessDirect sender channel names must start with PD_SND_</message>
            <apply-to>processdirect-sender-channel.name</apply-to>
        </naming>

        <!-- ProcessDirect Receiver Channels -->
        <naming>
            <scheme>
                <starts-with>PD_RCV_</starts-with>
            </scheme>
            <message>ProcessDirect receiver channel names must start with PD_RCV_</message>
            <apply-to>processdirect-receiver-channel.name</apply-to>
        </naming>

        <!-- SFTP Sender Channels -->
        <naming>
            <scheme>
                <starts-with>SFTP_SND_</starts-with>
            </scheme>
            <message>SFTP sender channel names must start with SFTP_SND_</message>
            <apply-to>sftp-sender-channel.name</apply-to>
        </naming>

        <!-- SFTP Receiver Channels -->
        <naming>
            <scheme>
                <starts-with>SFTP_RCV_</starts-with>
            </scheme>
            <message>SFTP receiver channel names must start with SFTP_RCV_</message>
            <apply-to>sftp-receiver-channel.name</apply-to>
        </naming>

        <!-- SOAP Sender Channels -->
        <naming>
            <scheme>
                <starts-with>SOAP_SND_</starts-with>
            </scheme>
            <message>SOAP sender channel names must start with SOAP_SND_</message>
            <apply-to>soap-sender-channel.name</apply-to>
        </naming>

        <!-- SOAP Receiver Channels -->
        <naming>
            <scheme>
                <starts-with>SOAP_RCV_</starts-with>
            </scheme>
            <message>SOAP receiver channel names must start with SOAP_RCV_</message>
            <apply-to>soap-receiver-channel.name</apply-to>
        </naming>

        <!-- Mail Sender Channels -->
        <naming>
            <scheme>
                <starts-with>MAIL_SND_</starts-with>
            </scheme>
            <message>Mail sender channel names must start with MAIL_SND_</message>
            <apply-to>mail-sender-channel.name</apply-to>
        </naming>

        <!-- Mail Receiver Channels -->
        <naming>
            <scheme>
                <starts-with>MAIL_RCV_</starts-with>
            </scheme>
            <message>Mail receiver channel names must start with MAIL_RCV_</message>
            <apply-to>mail-receiver-channel.name</apply-to>
        </naming>

        <!-- Flow Step Naming Conventions -->
        <!-- Content Modifier Steps -->
        <naming>
            <scheme>
                <starts-with>CM_</starts-with>
            </scheme>
            <message>Content Modifier step names must start with CM_</message>
            <apply-to>content-modifier.name</apply-to>
        </naming>

        <!-- NOT WORKING - Router Steps -->
        <naming>
            <scheme>
                <starts-with>RTE_</starts-with>
            </scheme>
            <message>Router step names must start with RTE_</message>
            <apply-to>router.name</apply-to>
        </naming>
    </rules>
</cpilint>